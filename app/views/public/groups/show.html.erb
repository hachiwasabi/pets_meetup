<div class="container my-4">
  <h2><%= @group.name %></h2>
  <p class="text-muted">作成者: <%= @group.owner.name %></p>

  <div class="card p-3 mb-4">
    <p><%= @group.description %></p>
  </div>

  <%# 参加申請ボタン（オーナー自身と既に申請/承認済みの場合は表示しない） %>
  <% unless @group.owner_id == current_user.id || @group.group_members.exists?(user_id: current_user.id) %>
    <%= button_to "参加申請する", join_request_group_path(@group), method: :post, class: "btn btn-primary" %>
  <% end %>

  <%# オーナー向け：承認待ちリスト表示 %>
  <% if @group.owner_id == current_user.id %>
    <div class="mt-4">
      <h4>申請中のメンバー</h4>
      <% if @pending_members.any? %>
        <table class="table">
          <thead>
            <tr>
              <th>ユーザー名</th>
              <th>操作</th>
            </tr>
          </thead>
          <tbody>
            <% @pending_members.each do |member| %>
              <tr>
                <td><%= member.user.name %></td>
                <td>
                  <%= button_to "承認", approve_member_group_path(@group, member_id: member.id), method: :patch, class: "btn btn-success btn-sm" %>
                  <%= button_to "拒否", reject_member_group_path(@group, member_id: member.id), method: :patch, class: "btn btn-danger btn-sm" %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      <% else %>
        <p class="text-muted">現在申請中のユーザーはいません。</p>
      <% end %>
    </div>
  <% end %>
  <div class="mt-5">
    <h4>参加メンバー一覧</h4>
    <% if @group.members.any? %>
      <ul class="list-group">
        <% @group.members.each do |member| %>
          <li class="list-group-item"><%= member.name %></li>
        <% end %>
      </ul>
    <% else %>
      <p class="text-muted">まだ参加メンバーはいません。</p>
    <% end %>
  </div>

</div>
