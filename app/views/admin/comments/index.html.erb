<h1>コメント管理</h1>

<p>全コメント一覧（新しい順）</p>

<% if @comments.any? %>
  <div class="list-group">
    <% @comments.each do |comment| %>
      <div class="list-group-item mb-2">
        <div class="d-flex justify-content-between align-items-start">
          <div>
            <strong><%= comment.user&.name || "ユーザー削除済み" %></strong>
            <small class="text-muted">（ID:<%= comment.user_id %>）</small>
            <br>
            <em>投稿: </em>
            <%= link_to truncate(comment.post&.title.to_s, length: 40), admin_post_path(comment.post) if comment.post %>
            <br>
            <span class="text-muted small">投稿日: <%= l(comment.created_at, format: :short) %></span>
          </div>

          <div class="text-end">
            <%= form_with url: admin_comment_path(comment), method: :delete, local: true do |f| %>
              <%= f.submit "削除", data: { confirm: "このコメントを完全に削除します。よろしいですか？" }, class: "btn btn-danger btn-sm" %>
            <% end %>
          </div>
        </div>

        <hr>
        <div>
          <%= simple_format(h(comment.content)) %>
        </div>
      </div>
    <% end %>
  </div>
<% else %>
  <p>コメントはまだありません。</p>
<% end %>

<%= link_to "管理トップへ戻る", admin_users_path || admin_posts_path, class: "btn btn-secondary mt-3" %>

<%= paginate @comments %>